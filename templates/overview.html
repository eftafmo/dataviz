{% extends "_layout.html" %}


{% block content %}
  {{ block.super }}
  <embeddor :components="vizcomponents"></embeddor>
{% endblock %}


{% block main %}
  <div class="homepage_content_wrapper">
    <overview
        :initial="dataset"
        period="{{ PERIOD }}"
    ></overview>
  </div>

  <form class="homepage-search" action="{% url 'frontend:search_programme' %}">
    <input
        id="search_request_input" type="search" name="q"
        placeholder="Search"
    >
    <a id="search_request" href="{% url 'frontend:search_programme' %}" class="icon icon-search"></a>
  </form>
{% endblock %}

{% block after_content %}
  <overview_funding
      :initial="dataset"
      period="{{ PERIOD }}"
  ></overview_funding>
  <overview_results
      :initial="dataset"
      period="{{ PERIOD }}"
  ></overview_results>
{% endblock after_content %}

{% block finally %}
  <script>
  document.addEventListener("DOMContentLoaded", () => {
    _createApp(
      Dataviz.Index,
      {
        datasource: "/api/overview.json"
      }
    ).mount("#content");
  });


  a_element = document.getElementById("search_request");
  input = document.getElementById("search_request_input");
  a_element.addEventListener("click", function () {

    a_element.href = a_element.href + "?q=" + input.value;

  });
  </script>
{% endblock %}
